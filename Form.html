<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Plate Buckling</title>
        <link rel="stylesheet" href="css/style.css" />
    </head>

    <body>
        <h1>Plate Buckling</h1><br>
        <h2>Inputs</h2>
        <form method="post" id="plate_buckling_inputs" class="input_box" onsubmit="sendData(event)">
            <div>
                <label for = "Component">Component Name:</label><br>
                <input type = "text" id = "Component" name = "Component"><br>
            </div>

            <div>
                <label for = "Length">Length:</label><br>
                <input type = "number" id = "a" name = "a" step="0.001" min="0"><br>
            </div>

            <div>
                <label for = "Width">Width:</label><br>
                <input type = "number" id = "b" name="b" step="0.001" min="0"><br>
            </div>

            <div>
                <label for = "Thickness">Thickness:</label><br>
                <input type = "number" id = "t" name = "t" step="0.001" min="0"><br>
            </div>

            <div>
                <label for = "Modulus">Modulus:</label><br>
                <input type = "number" id = "E" name = "E" min="0"><br>
            </div>

            <div>
                <label for = "Fcy">Material Yield Stress:</label><br>
                <input type = "number" id = "Fcy" name = "Fcy" step="0.001" min="0"><br>
            </div>

            <div>
                <label for = "n">Material Shape Parameter:</label><br>
                <input type = "number" id = "n" name = "n" step="0.001" min="0"><br>
            </div>

            <div>
                <label for = "Kc">Buckling Coefficient:</label><br>
                <input type = "number" id = "Kc" name = "Kc" step="0.01" min="0"><br>
            </div>

            <div>
                <label for = "Fc_cr_initial">Initial Guess of Buckling Stress:</label><br>
                <input type = "number" id = "Fc_cr_initial" name = "Fc_cr_initial" step="1" min="0"><br>
            </div>

            <div>
                <label for = "loading">Loading:</label><br>
                <select id = "loading" name = "loading">
                    <option value="compression">compression</option>
                    <option value="shear">shear</option>
                    <option value="bending">bending</option>
                </select><br>
            </div>

            <div>
                <br>
                <input type="submit" value="Calculate"><br>
            </div>

            <div>
                <h2>Results</h2>
                <label for = "buckling-allow">Buckling Allowable:</label>
                <output id="buckling-allow"></output>

            </div>
            
        </form>
        

    </body>

</html>

<script>

async function sendData(event) {
    event.preventDefault();
    console.log('sending data')

    let data = new FormData(document.getElementById('plate_buckling_inputs'));
    const packet = {
        msg_type:'buckling_data_entry',
        data:Object.fromEntries(data.entries())
    };
    console.log(packet)


    const url = "/inputs/";

    const response = await fetch(url,{
        method:"POST",
        headers:{
           "Content-Type":"application/json"
        },
        body:JSON.stringify(packet)
    });

    // check status code, if good then display result. If not, display error code.

    if (response.ok) {

        const data_json = await response.json();
        var result_data = JSON.parse(data_json);
        document.getElementById('buckling-allow').value = result_data['Fccr'];
    } else {

        document.getElementById('buckling-allow').value = response.statusText;
    }


    

}

</script>